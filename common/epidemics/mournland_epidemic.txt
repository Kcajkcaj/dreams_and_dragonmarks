mournland_epidemic = {
    trait = mourning_flu
    color = {60 60 60}
    priority = 10

    shader_data = {
		strength = 0.8
		edge_fade = 0.4
		tile_multiplier = 0.005
		texture_index = 0
		channel = green
	}

    name = {
        desc = epidemic_mournland
    }

    on_start = {
        if = {
			limit = { NOT = { has_global_variable = plague_happened } }
			set_global_variable = {
				name = plague_happened
				value = 1
			}
		}
		else = {
			change_global_variable = {
				name = plague_happened
				add = 1
			}
		}

        epidemic_outbreak_legitimacy_effect = { PROVINCE = root.outbreak_province }
    }

    on_monthly = {
		trigger_event = {
			on_action = epidemic_ongoing_events
		}
	}

    character_infection_chance = {
		value = character_infection_chance_default_value
	}

    can_infect_character = {
		can_contract_disease_trigger = { DISEASE = mourning_flu }
		immune_to_epidemic = { EPIDEMIC = scope:epidemic }
	}

    on_character_infected = {
		contract_disease_notify_effect = { DISEASE = mourning_flu }
	}

    infection_levels = {
		10 = {
			province_modifier = {
				monthly_county_control_decline_add = -0.6
				development_decline = -3
				levy_reinforcement_rate = -0.3
				levy_size = -0.25
				supply_limit_mult = -0.2
				county_opinion_add = -10
				epidemic_travel_danger = 25
			}	
		}
		50 = {
			province_modifier = {
				monthly_county_control_decline_add = -0.8
				development_decline = -6
				levy_reinforcement_rate = -0.5
				levy_size = -0.4
				supply_limit_mult = -0.5
				county_opinion_add = -25
				epidemic_travel_danger = 40
			}	
		}
		80 = {
			province_modifier = {
				monthly_county_control_decline_add = -0.8
				development_decline = -8
				levy_reinforcement_rate = -1
				levy_size = -0.5
				supply_limit_mult = -1
				county_opinion_add = -25
				epidemic_travel_danger = 60
			}
		}
	}

    outbreak_intensities = {
        minor = {
            outbreak_chance = {
                value = outbreak_chance_minor_default_value
				multiply = outbreak_chance_minor_mult_value
				multiply = recent_epidemics_outbreak_mult_value
                multiply = 0.1
				if = {
					limit = {
						not = {
							county.kingdom = title:k_eston
							county.kingdom = title:k_metrol
						}
					}
					multiply = 0
				}
            }
			spread_chance = {
				value = spread_chance_epidemics_default_value
				multiply = spread_chance_epidemics_mult_value
				if = {
					limit = {
						not = {
							county.kingdom = title:k_eston
							county.kingdom = title:k_metrol
						}
					}
					multiply = 0.1
				}
			}
            max_provinces = {50 100}
			infection_duration = { months = { 8 24 } }
			infection_progress_duration = { days = { 25 35 } }
			infection_recovery_duration = { days = { 50 70 } }
        }
        major = {
            outbreak_chance = {
                value = outbreak_chance_major_default_value
				multiply = outbreak_chance_major_mult_value
				multiply = recent_epidemics_outbreak_mult_value
				multiply = 100
				if = {
					limit = {
						not = {
							county.kingdom = title:k_eston
							county.kingdom = title:k_metrol
						}
					}
					multiply = 0
				}
            }
			spread_chance = {
				value = spread_chance_epidemics_default_value
				multiply = spread_chance_epidemics_mult_value
				if = {
					limit = {
						not = {
							county.kingdom = title:k_eston
							county.kingdom = title:k_metrol
						}
					}
					multiply = 0.1
				}
			}
            max_provinces = {100 200}
			infection_duration = { months = { 8 24 } }
			infection_progress_duration = { days = { 25 35 } }
			infection_recovery_duration = { days = { 50 70 } }
        }
        apocalyptic = {
            outbreak_chance = {
                value = outbreak_chance_apocalyptic_default_value
				multiply = outbreak_chance_apocalyptic_mult_value
				multiply = recent_epidemics_outbreak_mult_value
				if = {
					limit = {
						not = {
							county.kingdom = title:k_eston
							county.kingdom = title:k_metrol
						}
					}
					multiply = 0
				}
            }
			spread_chance = {
				value = spread_chance_epidemics_default_value
				multiply = spread_chance_epidemics_mult_value
				if = {
					limit = {
						not = {
							county.kingdom = title:k_eston
							county.kingdom = title:k_metrol
						}
					}
					multiply = 0.1
				}
			}
            max_provinces = {200 400}
			infection_duration = { months = { 8 24 } }
			infection_progress_duration = { days = { 25 35 } }
			infection_recovery_duration = { days = { 50 70 } }
        }
    }

	on_province_infected = {
		county = {
			apply_infection_development_loss = { BASE = 10 }
		}
	}

	on_province_recovered = {
		county = {
			remove_isolated_capital_modifiers_effect = yes
		}
		set_variable = {
			name = epidemic_cooldown_general
			years = 5
		}
		# Prosperity event
		plague_recovery_event_effect = yes
	}
}